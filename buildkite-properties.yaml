version: 1
pipelineType: node14

settings:
  buildCommand: "yarn ci-install && yarn ci-build"
  prBuildCommand: "touch cf-compliance.tar.gz && yarn ci-install && yarn ci-pullreq"
  buildkiteAgent: non-prod
  envGitRepo: bitbucket
  sonar:
    enable: true
    hostUrl: "https://sonar.trimble.tools"
    projectNamePrefix: "TTM - CF-PLATFORM - "
    projectKey: "TTM.CF-PLATFORM:cf-compliance"
    projectSecret: CF_PLATFORM_SONAR_KEY
    enforce: true

apps:
  cf-compliance:
    docker:
      dockerfile: .dockerfile/Dockerfile-cf-compliance
      imageName: pnet-core-teams/cf-compliance
    kubernetes:
      chartInRepo: false
      environmentRepo: ttm-cf-platform/core-teams-environments
      namespace:
        - core-teams-dev
      releaseName: cf-compliance
      imageTagPath: deployment.app.image.tag
